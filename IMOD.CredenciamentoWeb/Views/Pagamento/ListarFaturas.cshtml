@using DSBR.CrossCutting
@model IEnumerable<DSBR.ServicesWeb.ViewModel.FaturasViewModel>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header"></h1>
    </div>
    <!-- /.col-lg-12 -->
</div>

<div class="row">
    <div class="col-lg-12">

        <div class="panel panel-default">
            <div class="panel-heading" style="font-family: 'Francois One', sans-serif;">
               Faturas
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <div class="dataTable_wrapper">
                    <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                        <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Vencimento</th>
                            <th>Valor</th>
                            <th>Status</th>
                            <th>Hardware Info</th>
                            <th>Fatura</th>
                        </tr>
                        </thead>
                        <tbody>
                        @if (Model != null)
                        {
                            foreach (var item in Model)
                            {
                                <tr>

                                    @{ var id = Utils.EncryptAes(item.IdLicenca.ToString()); }
                                    <td>@item.Nome</td>
                                    <td>@item.DataVencimento.ToShortDateString()</td>
                                    <td>@item.ValorLicenca.ToString("C")</td>
                                    <td>@item.Status</td>
                                    <td>@item.NomeIdentificador</td>
                                  
                                    <td class="center">

                                        @{

                                            @Html.ActionLink("Download", "Download", "Licenca", new {idLic = id}, new {@class = "btn btn-default btn-xs"})
                                            @:&nbsp;

                                            //Somente faturas cujo status sejam diferentes de pagas podem exibir as opções EDITAR e EXCLUIR

                                            if (item.Status != "Pago")
                                            {

                                                @Ajax.ActionLink("Editar", "Comprar", "Licenca",
                                                new { idLic = id }
                                                ,
                                                new AjaxOptions
                                                {
                                                    HttpMethod = "GET",
                                                    UpdateTargetId = "dialog-modal",
                                                    InsertionMode = InsertionMode.Replace,
                                                    OnSuccess = "onShowModal('modal-page')"
                                                }, new { @class = "btn btn-info btn-xs" })

                                                @:&nbsp;

                                                @Ajax.ActionLink("Excluir", "Comprar", "Licenca",
                                                new { idLic = id }
                                                ,
                                                new AjaxOptions
                                                {
                                                    HttpMethod = "GET",
                                                    UpdateTargetId = "dialog-modal",
                                                    InsertionMode = InsertionMode.Replace,
                                                    OnSuccess = "onShowModal('modal-page')"
                                                }, new { @class = "btn btn-danger btn-xs" })
                                            }
                                        }

                                    </td>
                                </tr>
                            }
                        }


                        </tbody>
                    </table>
                </div>

            </div>
            <div id="dialog-modal"></div>

            <!-- /.panel-body -->
        </div>

        <!-- /.panel -->
    </div>
    <!-- /.col-lg-12 -->

</div>